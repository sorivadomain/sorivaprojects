{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MANUS DEI SECONDARY SCHOOL</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      max-width: 100vw;
      overflow-x: hidden;
      background: linear-gradient(to bottom, #1E3A8A, #000428);
      font-family: Arial, sans-serif;
      position: relative;
      box-sizing: border-box;
    }
    *, *:before, *:after {
      box-sizing: inherit;
    }
    .fish, .bubble {
      position: absolute;
      will-change: transform;
      animation-play-state: running;
      width: auto;
      max-width: 100vw;
      overflow: hidden;
    }
    .fish-1 { top: 10%; left: 5%; animation: swim 20s linear infinite; }
    .fish-2 { top: 30%; right: 5%; animation: swim 15s linear infinite reverse; }
    .fish-3 { bottom: 15%; left: 20%; animation: swim 25s linear infinite; }
    .fish-4 { top: 50%; left: 15%; animation: swim 18s linear infinite; }
    .fish-5 { bottom: 20%; right: 5%; animation: swim 22s linear infinite reverse; }
    .bubble-1 { bottom: 0; left: 10%; width: 10px; height: 10px; background: rgba(255, 255, 255, 0.3); border-radius: 50%; animation: bubble 5s linear infinite; }
    .bubble-2 { bottom: 0; left: 40%; width: 8px; height: 8px; background: rgba(255, 255, 255, 0.3); border-radius: 50%; animation: bubble 4s linear infinite 1s; }
    .bubble-3 { bottom: 0; right: 20%; width: 12px; height: 12px; background: rgba(255, 255, 255, 0.3); border-radius: 50%; animation: bubble 6s linear infinite 2s; }
    .container {
      width: 100%;
      max-width: 100vw;
      padding: 15px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      position: relative;
      z-index: 1;
      overflow-x: hidden;
    }
    .header {
      margin-bottom: 20px;
      width: 100%;
      max-width: 100%;
      overflow-x: hidden;
    }
    h1 {
      font-size: clamp(12px, 2.5vw, 20px);
      color: #E0F7FA;
      margin: 0;
      text-decoration: underline;
      white-space: nowrap;
      font-family: 'Comic Sans MS', cursive;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
      letter-spacing: 0.5px;
      max-width: 100%;
      overflow-x: hidden;
    }
    .logo-container {
      width: 70%;
      max-width: 70%;
      margin: 20px auto 0 auto;
      border-radius: 50%;
      overflow: hidden;
      background: #E0F7FA;
    }
    .logo-container img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    form {
      width: 90%;
      max-width: 650px;
      margin: 0 auto;
      overflow-x: hidden;
    }
    .input-container {
      width: 100%;
      max-width: 100%;
      position: relative;
      margin-bottom: 20px;
      overflow-x: hidden;
    }
    .input-field {
      font-size: 16px;
      line-height: 1.2;
      display: block;
      width: 100%;
      max-width: 100%;
      height: 50px;
      border-radius: 25px;
      border: none;
      outline: none;
      background: linear-gradient(to right, #B2EBF2, #80DEEA);
      padding: 0 15px 0 45px;
      color: #1E3A8A;
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
    }
    .input-icon {
      position: absolute;
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 100%;
      top: 0;
      left: 5px;
      pointer-events: none;
      color: #1E3A8A;
    }
    .password-toggle {
      position: absolute;
      font-size: 18px;
      color: #FF7518;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 100%;
      top: 0;
      right: 5px;
      cursor: pointer;
    }
    .checkbox-container {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      margin-bottom: 10px;
      width: 100%;
      max-width: 100%;
      overflow-x: hidden;
    }
    .checkbox-container input {
      cursor: pointer;
    }
    .checkbox-container label {
      margin-left: 8px;
      color: #E0F7FA;
      font-size: 16px;
      cursor: pointer;
    }
    #rememberInfo {
      display: none;
      color: #E0F7FA;
      margin-bottom: 20px;
      animation: fadeIn 1s forwards;
      width: 100%;
      max-width: 100%;
      overflow-x: hidden;
    }
    .form-button {
      font-size: 16px;
      color: #E0F7FA;
      line-height: 1.2;
      text-transform: uppercase;
      width: 100%;
      max-width: 100%;
      height: 50px;
      border-radius: 25px;
      border: none;
      cursor: pointer;
      outline: none;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      overflow-x: hidden;
    }
    .login-button {
      background: linear-gradient(to right, #0288D1, #01579B);
    }
    .signup-button, .map-button {
      border: 2px solid #E0F7FA;
      background: transparent;
    }
    a {
      text-decoration: none;
      width: 100%;
      max-width: 100%;
      overflow-x: hidden;
    }
    p {
      margin-top: 10px;
      font-size: 14px;
      color: #E0F7FA;
      line-height: 1.5;
      display: block;
      margin-bottom: 10px;
      width: 100%;
      max-width: 100%;
      overflow-x: hidden;
    }
    p a {
      text-decoration: underline;
      color: #E0F7FA;
      cursor: pointer;
    }
    .messages {
      width: 90%;
      max-width: 650px;
      margin: 0 auto 10px auto;
      text-align: center;
    }
    .messages p {
      margin: 5px 0;
      padding: 10px;
      border-radius: 5px;
      font-size: 16px;
      color: #FF6F61;
      background: rgba(255, 255, 255, 0.1);
    }
    @keyframes swim {
      0% { transform: translateX(0); }
      50% { transform: translateX(calc(80vw - 40px)); }
      100% { transform: translateX(0); }
    }
    @keyframes bubble {
      0% { transform: translateY(0); opacity: 0.8; }
      100% { transform: translateY(-100vh); opacity: 0; }
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @media (min-width: 576px) {
      .logo-container { width: 50% !important; max-width: 50% !important; }
    }
    @media (min-width: 992px) {
      .logo-container { width: 35% !important; max-width: 35% !important; }
      form { max-width: 650px !important; }
    }
    @media (min-width: 1200px) {
      .logo-container { width: 30% !important; max-width: 30% !important; }
    }
  </style>
</head>
<body>
  <!-- Animated Fish -->
  <div class="fish fish-1">üêü</div>
  <div class="fish fish-2">üê†</div>
  <div class="fish fish-3">üê°</div>
  <div class="fish fish-4">üêô</div>
  <div class="fish fish-5">üê¨</div>
  <!-- Bubbles -->
  <div class="bubble bubble-1"></div>
  <div class="bubble bubble-2"></div>
  <div class="bubble bubble-3"></div>

  <div class="container">
    <!-- Header with circular logo container -->
    <div class="header">
      <h1>WELCOME TO MANUS DEI SECONDARY SCHOOL üåü</h1>
      <div class="logo-container">
        <img src="{% static 'images/school.png' %}" alt="School Logo">
      </div>
    </div>

    <!-- Display messages -->
    <div class="messages">
      {% if messages %}
        {% for message in messages %}
          <p>{{ message }}</p>
        {% endfor %}
      {% endif %}
    </div>

    <!-- Login form -->
    <form method="post" action="{% url 'custom_login' %}" onsubmit="storeCredentials()">
      {% csrf_token %}

      <!-- Username field -->
      <div class="input-container">
        <input id="id_username" name="username" type="text" placeholder="Enter username... " class="input-field">
        <span class="input-icon">üë§</span>
      </div>

      <!-- Password field -->
      <div class="input-container">
        <input id="id_password" name="password" type="password" placeholder="Enter password...." class="input-field">
        <span class="input-icon">üîí</span>
        <span onclick="togglePasswordVisibility()" class="password-toggle">üëÅÔ∏è</span>
      </div>

      <!-- Remember me checkbox + animated info text -->
      <div class="checkbox-container">
        <input type="checkbox" id="rememberMe" onclick="toggleRememberInfo()">
        <label for="rememberMe">Remember Me ‚úÖ</label>
      </div>
      <div id="rememberInfo">Worry out, I will remember your credentials all the time üß†</div>

      <!-- Login button -->
      <button type="submit" value="Login" class="form-button login-button">üîë Login</button>

      <!-- Signup button -->
      <a href="{% url 'signup' %}">
        <button type="button" class="form-button signup-button">‚ûï Signup</button>
      </a>

      <!-- View in Map button -->
      <a href="{% url 'welcome' %}">
        <button type="button" class="form-button map-button">üó∫Ô∏è View in Map</button>
      </a>

      <!-- Visit our website button -->
      <a href="{% url 'website_welcome' %}" target="_blank">
        <button type="button" class="form-button map-button">üåê Visit our website</button>
      </a>

      <!-- "Forgot your password?" link -->
      <p>
        <a href="{% url 'forgot_password' %}">Forgot your password? You can request a new one here üîß</a>
      </p>

      <!-- Assistance info -->
      <p>
        For more assistance, you can contact us via phone at üìû
        <a href="tel:255741943155">255741943155</a>
        or email at üìß
        <a href="mailto:manusdei@gmail.com">manusdei@gmail.com</a>
      </p>

      <!-- Developer info -->
      <p>
        Developed by SORIVA COMPANY LIMITED, for more services like this please contact us via üìû
        phone:
        <a href="tel:255741943155">255741943155</a> /
        <a href="tel:255762023662">255619043757</a>
        or email: üìß
        <a href="mailto:sorivacompany123@gmail.com">sorivacompany123@gmail.com</a>
      </p>
    </form>
  </div>

  <script>
    // Toggle password visibility
    function togglePasswordVisibility() {
      const passwordField = document.getElementById("id_password");
      const passwordEye = document.querySelector("[onclick='togglePasswordVisibility()']");
      if (passwordField.type === "password") {
        passwordField.type = "text";
        passwordEye.textContent = "üëÅÔ∏è‚Äçüó®Ô∏è";
      } else {
        passwordField.type = "password";
        passwordEye.textContent = "üëÅÔ∏è";
      }
    }

    // Show/hide "Worry out..." text with simple fadeIn effect
    function toggleRememberInfo() {
      const info = document.getElementById("rememberInfo");
      if (document.getElementById("rememberMe").checked) {
        info.style.display = "block";
      } else {
        info.style.display = "none";
      }
    }

    // Store credentials if "Remember Me" is checked
    function storeCredentials() {
      if (document.getElementById("rememberMe").checked) {
        localStorage.setItem("username", document.getElementById("id_username").value);
        localStorage.setItem("password", document.getElementById("id_password").value);
      } else {
        localStorage.removeItem("username");
        localStorage.removeItem("password");
      }
    }

    // Load stored credentials on page load
    function loadCredentials() {
      const savedUsername = localStorage.getItem("username");
      const savedPassword = localStorage.getItem("password");
      if (savedUsername && savedPassword) {
        document.getElementById("id_username").value = savedUsername;
        document.getElementById("id_password").value = savedPassword;
        document.getElementById("rememberMe").checked = true;
        document.getElementById("rememberInfo").style.display = "block";
      }
    }

    // Fetch geolocation on page load
    function getLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition, showError);
      } else {
        alert("Geolocation is not supported by this browser.");
      }
    }
    function showPosition(position) {
      // Geolocation fields can be added if needed
    }
    function showError(error) {
      switch(error.code) {
        case error.PERMISSION_DENIED:
          break;
        case error.POSITION_UNAVAILABLE:
          break;
        case error.TIMEOUT:
          break;
        case error.UNKNOWN_ERROR:
          break;
      }
    }

    // Initialize on page load
    document.addEventListener("DOMContentLoaded", function() {
      loadCredentials();
      getLocation();
    });
  </script>
</body>
</html>